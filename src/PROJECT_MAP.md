
Перед выполнением любой работы ОБЯЗАТЕЛЬНО прочитай PROJECT_MAP.md.

Цель:
Работать, используя PROJECT_MAP.md как единственный источник структуры проекта,
сохраняя минимальный трафик.

Правила:
1. Репозиторий целиком НЕ сканировать.
2. Работать только по информации из PROJECT_MAP.md.
3. Если информация в карте неточна, действовать строго по правилам ниже.

Коррекция карты:
- Если обнаружена мелкая неточность —
  обнови описание в PROJECT_MAP.md без дополнительного поиска.
- Если нужного файла нет в карте —
  разрешён ОДИН точечный поиск (одна папка или один запрос),
  после чего ОБЯЗАТЕЛЬНО обнови PROJECT_MAP.md.
- Если расхождение то актуализируй PROJECT_MAP.md

Формат ответа СТРОГО:
PLAN
COMMANDS
DONE

Никаких объяснений, рассуждений и лишнего вывода.


# PROJECT_MAP.md

## Общая информация
Проект: Embedded/IoT проект на PlatformIO (ESP/Arduino-класс устройств)  
Назначение: работа с датчиками, UI (Nextion), MQTT, Modbus RTU (RS485), Web-интерфейс, LED WS2815.

---

## Структура репозитория

### Корень проекта
- `platformio.ini` — конфигурация PlatformIO (платы, фреймворк, библиотеки)
- `README.md` — общее описание проекта
- `.gitignore` — исключения Git

---

## src/

### Точка входа
- `src/main.cpp`  
  Главный файл прошивки.  
  Инициализация модулей, setup/loop, связывание подсистем.

---

### Датчики и измерения
- `src/ds18.h` — датчик температуры DS18B20
- `src/NT_Time.h` — работа со временем / NTP / тайминг
- `src/PH_CL2.h` — датчики pH / CL2 (хлор)
- `src/Slow.h` — медленные/фоновые измерения

---

### Связь и протоколы
- `src/settings_MQTT.h` — настройки MQTT (сервер, топики, авторизация)
- `src/ModbusRTU_RS485.h` — Modbus RTU по RS485
- `src/wifi_manager.h` — подключение и управление Wi‑Fi

---

### UI / Nextion
- `src/Nextion_Rx.h` — приём данных от дисплея Nextion
- `src/Nextion_Tx.h` — отправка данных на Nextion
- `src/interface_-_JeeUI2.h` — логика интерфейса
- `src/ui_-_JeeUI2.h` — UI-уровень, экраны, элементы

---

### Web
- `src/web.h` — веб-интерфейс (страницы, API)
- `src/WebUpdate.h` — OTA / обновление прошивки через Web

---

### LED
- `src/LED_WS2815.h` — управление адресной LED-лентой WS2815

---

### Таймеры и логика
- `src/Timer_Relay.h` — таймеры, реле, задержки

---

## src/src/ (внутренние утилиты)
- `src/src/fs_utils.h` — работа с файловой системой
- `src/src/graph.h` — графики / визуализация данных
- `src/src/GradientPalettes.h` — цветовые палитры / градиенты

---

## Правила работы для Codex / AI

- **Запрещено** сканировать весь репозиторий.
- Использовать эту карту как основной источник структуры.
- Поиск (`rg`, `grep`) — только по файлам, указанным выше.
- При добавлении новых файлов — обновлять `PROJECT_MAP.md`.

---

## Команды сборки (PlatformIO)

- Сборка: `pio run`
- Загрузка: `pio run -t upload`
- Монитор: `pio device monitor`

---

## Примечания
Этот файл используется как "память проекта" для AI и должен поддерживаться в актуальном состоянии.
